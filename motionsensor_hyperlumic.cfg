[filament_motion_sensor Avance_filament]
switch_pin: ^PB11 #SDA, PF15 pour DET2, PB10 pour SCL (IDRE)
detection_length: 6
extruder: extruder
pause_on_runout: False
runout_gcode:
	{% set sysstate = printer["virtual_sdcard"] %}
	{% if sysstate.is_active == True %}
		SET_DISPLAY_TEXT MSG="Blocage de filament detectée ! Verifiez votre filament, votre compresseur et votre tête d'impression."
		RESPOND TYPE=command MSG="Blocage de filament detectée ! Verifiez votre filament, votre compresseur et votre tête d'impression."
		RESPOND TYPE=command MSG="action:prompt_begin Blocage filament"
		RESPOND TYPE=command MSG="action:prompt_text Des blocages de filament ont été détectés, mise en pause pour vérification."
		RESPOND TYPE=command MSG="action:prompt_footer_button OK|CLOSE_PROMPT|primary"
		RESPOND TYPE=command MSG="action:prompt_show"
		PAUSE
	{% endif %}
insert_gcode:

[gcode_macro CLOSE_PROMPT]
gcode:
    RESPOND TYPE=command MSG=action:prompt_end
